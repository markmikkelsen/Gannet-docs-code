<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Reference</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="site_libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />
<!DOCTYPE html>
<link rel="shortcut icon" href="images/logo.png" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>

<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Gannet</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Documentation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="getting-started.html">Getting started</a>
    </li>
    <li>
      <a href="reference.html">Reference</a>
    </li>
    <li>
      <a href="output-structure-attributes.html">Output structure attributes</a>
    </li>
    <li>
      <a href="preprocessing.html">Preprocessing</a>
    </li>
    <li>
      <a href="signal-modeling.html">Signal modeling</a>
    </li>
    <li>
      <a href="data-quality-metrics.html">Data quality metrics</a>
    </li>
    <li>
      <a href="quantification-tissue-correction.html">Quantification &amp; tissue correction</a>
    </li>
    <li>
      <a href="additional-tools.html">Additional tools</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="gannetpreinitialise-settings.html">GannetPreInitialise settings</a>
    </li>
    <li>
      <a href="batch-script.html">Batch processing script</a>
    </li>
    <li>
      <a href="joining-data-files.html">Joining data files</a>
    </li>
  </ul>
</li>
<li>
  <a href="faq.html">FAQ</a>
</li>
<li>
  <a href="release-notes.html">Release notes</a>
</li>
<li>
  <a href="https://forum.mrshub.org/c/mrs-software/gannet/9">Forum</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/markmikkelsen/Gannet/issues">Report an issue</a>
</li>
<li>
  <a href="https://github.com/markmikkelsen/Gannet">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="mailto:mam4041@med.cornell.edu?subject=[Gannet]%20&lt;Please enter the subject of your query here&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Reference</h1>
<h4 class="date">Last updated: January 13, 2024</h4>

</div>


<button onclick="topFunction()" id="myBtn" title="Go to top">
Back to top
</button>
<script>
//Get the button
var mybutton = document.getElementById("myBtn");

// When the user scrolls down 20px from the top of the document, show the button
window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
    mybutton.style.display = "block";
  } else {
    mybutton.style.display = "none";
  }
}

// When the user clicks on the button, scroll to the top of the document
function topFunction() {
  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;
}
</script>
<p><br></p>
<div class="info">
<p><i class="fa fa-info-circle" style="color: white"></i>  The variables
listed on this page are applicable to releases 3.3.0+ and are not
necessarily correct for older versions of Gannet.</p>
</div>
<div id="pre-initializing-gannet" class="section level2 hasAnchor">
<h2 class="hasAnchor">Pre-initializing Gannet<a
href="#pre-initializing-gannet" class="anchor-section"
aria-label="Anchor link to header"></a></h2>
<p><br></p>
<p><strong>Parent function</strong></p>
<p><code>GannetPreInitialise.m</code></p>
<p><br></p>
<table>
<colgroup>
<col width="26%" />
<col width="73%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><u>Acquisition parameters</u></th>
<th align="left"><u>Description</u></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>target</code></td>
<td align="left">Sets the metabolite of interest that was edited in the
MRS experiment; if HERMES or HERCULES was used, multiple metabolites
should be selected</td>
</tr>
<tr class="even">
<td align="left"><code>seqorig</code></td>
<td align="left">Origin of the Philips MEGA-PRESS or GE HERMES
sequences</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col width="26%" />
<col width="73%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><u>Analysis parameters</u></th>
<th align="left"><u>Description</u></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>LB</code></td>
<td align="left">Sets the amount of exponential line-broadening to apply
to the data (in Hz)</td>
</tr>
<tr class="even">
<td align="left"><code>water_ECC</code></td>
<td align="left">Whether to perform an eddy-current correction<span
class="citation"><sup><a href="#ref-Klose1990">1</a></sup></span> on the
water data</td>
</tr>
<tr class="odd">
<td align="left"><code>metab_ECC</code></td>
<td align="left">Whether to perform an eddy-current correction on the
metabolite data</td>
</tr>
<tr class="even">
<td align="left"><code>water_removal</code></td>
<td align="left">Whether to remove the residual water signal from the
difference spectra using an HSVD filter<span class="citation"><sup><a
href="#ref-Barkhuijsen1987">2</a></sup></span></td>
</tr>
<tr class="odd">
<td align="left"><code>alignment</code></td>
<td align="left">Which method to use for shot-to-shot
frequency-and-phase correction<span class="citation"><sup><a
href="#ref-Evans2013">3</a>–<a
href="#ref-Mikkelsen2020">6</a></sup></span></td>
</tr>
<tr class="even">
<td align="left"><code>use_prealign_ref</code></td>
<td align="left">In some cases, using <code>RobustSpecReg</code> to
align HERMES/HERCULES data can result in worse alignment compared to the
pre-aligned data; setting this parameter to 1 will make
<code>RobustSpecReg</code> use the averaged pre-aligned subspectra as
references to align the averaged post-aligned subspectra, which may
improve the final alignment; this has not be tested extensively</td>
</tr>
<tr class="odd">
<td align="left"><code>fit_resid_water</code></td>
<td align="left">Whether to model the residual water signal in the
difference spectrum; used to calculate a water suppression factor</td>
</tr>
<tr class="even">
<td align="left"><code>weighted_averaging</code></td>
<td align="left">Whether to average the data using weighted averaging;
the default approach use is mean-squared error, but other approaches can
be set in <code>SignalAveraging.m</code></td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col width="26%" />
<col width="73%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><u>Flags</u></th>
<th align="left"><u>Description</u></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>HERMES</code></td>
<td align="left">Set to <code>1</code> if the data were acquired using
HERMES</td>
</tr>
<tr class="even">
<td align="left"><code>HERCULES</code></td>
<td align="left">Set to <code>1</code> if the data were acquired using
HERCULES (<code>HERMES</code> must also be set to <code>1</code>)</td>
</tr>
<tr class="odd">
<td align="left"><code>PRIAM</code></td>
<td align="left">Set to <code>1</code> if the data were acquired using
PRIAM</td>
</tr>
<tr class="even">
<td align="left"><code>phantom</code></td>
<td align="left">Set to <code>1</code> if the data were acquired in a
phantom</td>
</tr>
<tr class="odd">
<td align="left"><code>join</code></td>
<td align="left">Set to <code>1</code> to join multiple files (this can
be batched across subjects)</td>
</tr>
<tr class="even">
<td align="left"><code>mat</code></td>
<td align="left">Set to <code>1</code> to save the output structure as a
MAT-file</td>
</tr>
<tr class="odd">
<td align="left"><code>csv</code></td>
<td align="left">Set to <code>1</code> to export a CSV file containing
useful data for statistical analysis (applies to
<code>GannetFit.m</code>, <code>GannetSegment.m</code> and
<code>GannetQuantify.m</code>)</td>
</tr>
<tr class="even">
<td align="left"><code>append</code></td>
<td align="left">Set to <code>1</code> to append PDF outputs into one
PDF (separately for each module) (requires <code>export_fig/</code> in
the <code>Gannet/</code> directory to be added to the search path and
<a href="https://www.ghostscript.com/" target="_blank">Ghostscript</a>
to be installed on the user’s machine (NB: macOS users should use
<a href="https://pages.uoregon.edu/koch/" target="_blank">this
version</a> or use
<a href="https://formulae.brew.sh/formula/ghostscript" target="_blank">Homebrew</a>
to install Ghostscript)</td>
</tr>
<tr class="odd">
<td align="left"><code>hide</code></td>
<td align="left">Set to <code>1</code> to not display output
figures</td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="loading-preprocessing" class="section level2 hasAnchor">
<h2 class="hasAnchor">Loading &amp; preprocessing<a
href="#loading-preprocessing" class="anchor-section"
aria-label="Anchor link to header"></a></h2>
<p><br></p>
<p><strong>Parent function</strong></p>
<p><code>GannetLoad.m</code></p>
<p><br></p>
<p><strong>Example usage:</strong></p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode octave"><code class="sourceCode octave"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>MRS_struct <span class="op">=</span> GannetLoad({<span class="st">&#39;S01_GABA_68_act.sdat&#39;</span>}<span class="op">,</span> {<span class="st">&#39;S01_GABA_68_ref.sdat&#39;</span>})<span class="op">;</span></span></code></pre></div>
<p>Output:</p>
<p><img src="images/reference/GannetLoad-example.png" alt="A screenshot example of GannetLoad output"></p>
<ol style="list-style-type: upper-alpha">
<li><p>Edited difference spectra before and after frequency and phase
alignment. Users should look out for poor alignment and signal
distortions from lipid contamination or ghosting artifacts<span
class="citation"><sup><a
href="#ref-Kreis2004">7</a></sup></span>.</p></li>
<li><p>The observed frequency of either the residual water signal or 3
ppm Cr peak on a average-by-average basis. Users can use this panel to
check for participant motion and/or scanner-related frequency drift. The
solid black line is the nominal water or 3 ppm Cr frequency, while the
dashed lines represent +/-1 standard deviation of population-level
frequency offsets observed in the Big GABA study<span
class="citation"><sup><a href="#ref-Mikkelsen2017">8</a></sup></span>.
In other words, frequency shifts beyond these limits indicates
above-average offsets that should be of concern to data
fidelity.</p></li>
<li><p>A spectrogram of the 3 ppm Cr signal average by average before
and after frequency and phase alignment. These data complement the data
shown in panel B by additionally showing spectral distortions in each
average.</p></li>
<li><p>Textual details of the data and processing procedures. When “n/a
- wgt. avg. used” is shown for “Rejects”, this means the data were
averaged using weighted averaging, which down-weights bad (i.e.,
“rejected”) averages.</p></li>
</ol>
<hr />
</div>
<div id="signal-fitting" class="section level2 hasAnchor">
<h2 class="hasAnchor">Signal fitting<a href="#signal-fitting"
class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><br></p>
<p><strong>Parent function</strong></p>
<p><code>GannetFit.m</code></p>
<p><br></p>
<p><strong>Example usage:</strong></p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode octave"><code class="sourceCode octave"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>MRS_struct <span class="op">=</span> GannetLoad({<span class="st">&#39;S01_GABA_68_act.sdat&#39;</span>}<span class="op">,</span> {<span class="st">&#39;S01_GABA_68_ref.sdat&#39;</span>})<span class="op">;</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>MRS_struct <span class="op">=</span> GannetFit(MRS_struct)<span class="op">;</span></span></code></pre></div>
<p>Output:</p>
<p><img src="images/reference/GannetFit-example.png" alt="A screenshot example of GannetFit output"></p>
<ol style="list-style-type: upper-alpha">
<li><p>Edited difference spectrum (spectra) with fitted model
function(s) overlaid. The fit residuals are also shown. NB: When
modeling the GABA peak, Gannet applies weights to the residual Cho
signal data points at 3.16 to 3.285 ppm. This improves fitting of the
GABA peak when there are subtraction artifacts.</p></li>
<li><p>Reference spectra (water and Cr) with fitted model functions
overlaid. The fit residuals are also shown. If no water reference data
was given during data loading, only Cr is shown.</p></li>
<li><p>Textual results from GannetFit (full details can be found on the
<a
href="https://markmikkelsen.github.io/Gannet-docs/data-quality-metrics.html">Data
quality metrics</a> page). For the metabolites listed:</p>
<ul>
<li>Area is the integrated signal (in arbitrary units) of the peaks
shown</li>
<li>Linewidth is the full-width, half-maximum (FWHM) (in Hz)</li>
<li>SNR is defined as the signal model amplitude divided by twice the
standard deviation of noise</li>
<li>Fit error is defined as the standard deviation of residuals divided
by the signal model amplitude multiplied by 100</li>
<li>Quantification details can be found on the <a
href="https://markmikkelsen.github.io/Gannet-docs/quantification-tissue-correction.html">Quantification
&amp; tissue correction</a> page.</li>
</ul></li>
</ol>
<hr />
</div>
<div id="voxel-co-registration" class="section level2 hasAnchor">
<h2 class="hasAnchor">Voxel co-registration<a
href="#voxel-co-registration" class="anchor-section"
aria-label="Anchor link to header"></a></h2>
<p><br></p>
<p><strong>Parent function</strong></p>
<p><code>GannetCoRegister.m</code></p>
<p><br></p>
<p><strong>Example usage:</strong></p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode octave"><code class="sourceCode octave"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>MRS_struct <span class="op">=</span> GannetLoad({<span class="st">&#39;S01_GABA_68_act.sdat&#39;</span>}<span class="op">,</span> {<span class="st">&#39;S01_GABA_68_ref.sdat&#39;</span>})<span class="op">;</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>MRS_struct <span class="op">=</span> GannetFit(MRS_struct)<span class="op">;</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>MRS_struct <span class="op">=</span> GannetCoRegister(MRS_struct<span class="op">,</span> {<span class="st">&#39;S01_struc.nii&#39;</span>})<span class="op">;</span></span></code></pre></div>
<p>Output:</p>
<p><img src="images/reference/GannetCoRegister-example.png" alt="A screenshot example of GannetCoRegister output"></p>
<ol style="list-style-type: upper-alpha">
<li><p>Co-registration of the MRS voxel on the corresponding structural
MR image. The three orthogonal slices are shown at the voxel
center.</p></li>
<li><p>Textual details of the voxel geometry.</p></li>
</ol>
<hr />
</div>
<div id="tissue-segmentation" class="section level2 hasAnchor">
<h2 class="hasAnchor">Tissue segmentation<a href="#tissue-segmentation"
class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><br></p>
<p><strong>Parent function</strong></p>
<p><code>GannetSegment.m</code></p>
<p><br></p>
<p><strong>Example usage:</strong></p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode octave"><code class="sourceCode octave"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>MRS_struct <span class="op">=</span> GannetLoad({<span class="st">&#39;S01_GABA_68_act.sdat&#39;</span>}<span class="op">,</span> {<span class="st">&#39;S01_GABA_68_ref.sdat&#39;</span>})<span class="op">;</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>MRS_struct <span class="op">=</span> GannetFit(MRS_struct)<span class="op">;</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>MRS_struct <span class="op">=</span> GannetCoRegister(MRS_struct<span class="op">,</span> {<span class="st">&#39;S01_struc.nii&#39;</span>})<span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>MRS_struct <span class="op">=</span> GannetSegment(MRS_struct)<span class="op">;</span></span></code></pre></div>
<p>Output:</p>
<p><img src="images/reference/GannetSegment-example.png" alt="A screenshot example of GannetSegment output"></p>
<ol style="list-style-type: upper-alpha">
<li><p>Axial view of the probabilistic voxel tissue segmentation maps
for grey matter (GM), white matter (WM), and cerebrospinal fluid
(CSF).</p></li>
<li><p>Textual details of the CSF-corrected metabolites values (see <a
href="https://markmikkelsen.github.io/Gannet-docs/quantification-tissue-correction.html">Quantification
&amp; tissue correction</a> for further details) and the voxel tissue
volume fractions.</p></li>
</ol>
<hr />
</div>
<div id="quantification" class="section level2 hasAnchor">
<h2 class="hasAnchor">Quantification<a href="#quantification"
class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><br></p>
<p><strong>Parent function</strong></p>
<p><code>GannetQuantify.m</code></p>
<p><br></p>
<p><strong>Example usage:</strong></p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode octave"><code class="sourceCode octave"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>MRS_struct <span class="op">=</span> GannetLoad({<span class="st">&#39;S01_GABA_68_act.sdat&#39;</span>}<span class="op">,</span> {<span class="st">&#39;S01_GABA_68_ref.sdat&#39;</span>})<span class="op">;</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>MRS_struct <span class="op">=</span> GannetFit(MRS_struct)<span class="op">;</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>MRS_struct <span class="op">=</span> GannetCoRegister(MRS_struct<span class="op">,</span> {<span class="st">&#39;S01_struc.nii&#39;</span>})<span class="op">;</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>MRS_struct <span class="op">=</span> GannetSegment(MRS_struct)<span class="op">;</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>MRS_struct <span class="op">=</span> GannetQuantify(MRS_struct)<span class="op">;</span></span></code></pre></div>
<p>Output:</p>
<p><img src="images/reference/GannetQuantify-example.png" alt="A screenshot example of GannetQuantify output"></p>
<ol style="list-style-type: upper-alpha">
<li><p>Axial view of the probabilistic voxel tissue segmentation maps
for grey matter (GM), white matter (WM), and cerebrospinal fluid
(CSF).</p></li>
<li><p>Edited difference spectrum (spectra) with fitted model
function(s) overlaid.</p></li>
<li><p>Textual details of tissue-corrected metabolite values (see <a
href="https://markmikkelsen.github.io/Gannet-docs/quantification-tissue-correction.html">Quantification
&amp; tissue correction</a> for further details).</p></li>
</ol>
<p><br></p>
<div id="references" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">References<a href="#references"
class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-Klose1990" class="csl-entry">
<div class="csl-left-margin">1. </div><div
class="csl-right-inline">Klose U. <span class="nocase">In vivo proton
spectroscopy in presence of eddy currents</span>. <em>Magnetic Resonance
in Medicine</em>. 1990;14(1):26-30. doi:<a
href="https://doi.org/10.1002/mrm.1910140104">10.1002/mrm.1910140104</a></div>
</div>
<div id="ref-Barkhuijsen1987" class="csl-entry">
<div class="csl-left-margin">2. </div><div
class="csl-right-inline">Barkhuijsen H, Beer R de, Ormondt D van. <span
class="nocase">Improved algorithm for noniterative time-domain model
fitting to exponentially damped magnetic resonance signals</span>.
<em>Journal of Magnetic Resonance</em>. 1987;73(3):553-557. doi:<a
href="https://doi.org/10.1016/0022-2364(87)90023-0">10.1016/0022-2364(87)90023-0</a></div>
</div>
<div id="ref-Evans2013" class="csl-entry">
<div class="csl-left-margin">3. </div><div
class="csl-right-inline">Evans CJ, Puts NAJ, Robson SE, et al. <span
class="nocase">Subtraction artifacts and frequency (Mis-)alignment in
J-difference GABA editing</span>. <em>Journal of Magnetic Resonance
Imaging</em>. 2013;38(4):970-975. doi:<a
href="https://doi.org/10.1002/jmri.23923">10.1002/jmri.23923</a></div>
</div>
<div id="ref-Near2015" class="csl-entry">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Near
J, Edden R, Evans CJ, Paquin R, Harris A, Jezzard P. <span
class="nocase">Frequency and phase drift correction of magnetic
resonance spectroscopy data by spectral registration in the time
domain</span>. <em>Magnetic Resonance in Medicine</em>.
2015;73(1):44-50. doi:<a
href="https://doi.org/10.1002/mrm.25094">10.1002/mrm.25094</a></div>
</div>
<div id="ref-Mikkelsen2018" class="csl-entry">
<div class="csl-left-margin">5. </div><div
class="csl-right-inline">Mikkelsen M, Saleh MG, Near J, et al. <span
class="nocase">Frequency and phase correction for multiplexed edited MRS
of GABA and glutathione</span>. <em>Magnetic Resonance in Medicine</em>.
2018;80(1):21-28. doi:<a
href="https://doi.org/10.1002/mrm.27027">10.1002/mrm.27027</a></div>
</div>
<div id="ref-Mikkelsen2020" class="csl-entry">
<div class="csl-left-margin">6. </div><div
class="csl-right-inline">Mikkelsen M, Tapper S, Near J, Mostofsky SH,
Puts NAJ, Edden RAE. <span class="nocase">Correcting frequency and phase
offsets in MRS data using robust spectral registration</span>. <em>NMR
in Biomedicine</em>. 2020;33(10):e4368. doi:<a
href="https://doi.org/10.1002/nbm.4368">10.1002/nbm.4368</a></div>
</div>
<div id="ref-Kreis2004" class="csl-entry">
<div class="csl-left-margin">7. </div><div
class="csl-right-inline">Kreis R. <span class="nocase">Issues of
spectral quality in clinical1H-magnetic resonance spectroscopy and a
gallery of artifacts</span>. <em>NMR in Biomedicine</em>.
2004;17(6):361-381. doi:<a
href="https://doi.org/10.1002/nbm.891">10.1002/nbm.891</a></div>
</div>
<div id="ref-Mikkelsen2017" class="csl-entry">
<div class="csl-left-margin">8. </div><div
class="csl-right-inline">Mikkelsen M, Barker PB, Bhattacharyya PK, et
al. <span class="nocase">Big GABA: Edited MR spectroscopy at 24 research
sites</span>. <em>NeuroImage</em>. 2017;159:32-45. doi:<a
href="https://doi.org/10.1016/j.neuroimage.2017.07.021">10.1016/j.neuroimage.2017.07.021</a></div>
</div>
</div>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiUmVmZXJlbmNlIgpkYXRlOiAiTGFzdCB1cGRhdGVkOiBgciBmb3JtYXQoU3lzLnRpbWUoKSwgJyVCICVkLCAlWScpYCIKb3V0cHV0OgogIGh0bWxfZG9jdW1lbnQ6CiAgICB0b2M6IFRSVUUKICAgIHRvY19kZXB0aDogMgogICAgdG9jX2Zsb2F0OgogICAgICBjb2xsYXBzZWQ6IEZBTFNFCmJpYmxpb2dyYXBoeTogcmVmZXJlbmNlcy5iaWIKY3NsOiBhbWVyaWNhbi1tZWRpY2FsLWFzc29jaWF0aW9uLmNzbApsaW5rLWNpdGF0aW9uczogeWVzCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFKQpgYGAKCmBgYHtyLCBjaGlsZCA9ICJqcy9iYWNrLXRvLXRvcC5qcyJ9CmBgYAoKPGJyPgoKOjo6IGluZm8KPGkgY2xhc3M9ImZhIGZhLWluZm8tY2lyY2xlIiBzdHlsZT0iY29sb3I6IHdoaXRlIj48L2k+Jm5ic3A7IFRoZSB2YXJpYWJsZXMgbGlzdGVkIG9uIHRoaXMgcGFnZSBhcmUgYXBwbGljYWJsZSB0byByZWxlYXNlcyAzLjMuMCsgYW5kIGFyZSBub3QgbmVjZXNzYXJpbHkgY29ycmVjdCBmb3Igb2xkZXIgdmVyc2lvbnMgb2YgR2FubmV0Lgo6OjoKCiMjIFByZS1pbml0aWFsaXppbmcgR2FubmV0Cgo8YnI+CgoqKlBhcmVudCBmdW5jdGlvbioqCgpgR2FubmV0UHJlSW5pdGlhbGlzZS5tYAoKPGJyPgoKfCA8dT5BY3F1aXNpdGlvbiBwYXJhbWV0ZXJzPC91PiB8IDx1PkRlc2NyaXB0aW9uPC91PiB8Cnw6LS0tLS0tLS0tLS0tLS0tLS0tfDotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfAp8IGB0YXJnZXRgIHwgU2V0cyB0aGUgbWV0YWJvbGl0ZSBvZiBpbnRlcmVzdCB0aGF0IHdhcyBlZGl0ZWQgaW4gdGhlIE1SUyBleHBlcmltZW50OyBpZiBIRVJNRVMgb3IgSEVSQ1VMRVMgd2FzIHVzZWQsIG11bHRpcGxlIG1ldGFib2xpdGVzIHNob3VsZCBiZSBzZWxlY3RlZCB8CnwgYHNlcW9yaWdgIHwgT3JpZ2luIG9mIHRoZSBQaGlsaXBzIE1FR0EtUFJFU1Mgb3IgR0UgSEVSTUVTIHNlcXVlbmNlcyB8Cgp8IDx1PkFuYWx5c2lzIHBhcmFtZXRlcnM8L3U+IHwgPHU+RGVzY3JpcHRpb248L3U+IHwKfDotLS0tLS0tLS0tLS0tLS0tLS18Oi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18CnwgYExCYCB8IFNldHMgdGhlIGFtb3VudCBvZiBleHBvbmVudGlhbCBsaW5lLWJyb2FkZW5pbmcgdG8gYXBwbHkgdG8gdGhlIGRhdGEgKGluIEh6KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8CnwgYHdhdGVyX0VDQ2AgfCBXaGV0aGVyIHRvIHBlcmZvcm0gYW4gZWRkeS1jdXJyZW50IGNvcnJlY3Rpb24gW0BLbG9zZTE5OTBdIG9uIHRoZSB3YXRlciBkYXRhICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAp8IGBtZXRhYl9FQ0NgIHwgV2hldGhlciB0byBwZXJmb3JtIGFuIGVkZHktY3VycmVudCBjb3JyZWN0aW9uIG9uIHRoZSBtZXRhYm9saXRlIGRhdGEgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwKfCBgd2F0ZXJfcmVtb3ZhbGAgfCBXaGV0aGVyIHRvIHJlbW92ZSB0aGUgcmVzaWR1YWwgd2F0ZXIgc2lnbmFsIGZyb20gdGhlIGRpZmZlcmVuY2Ugc3BlY3RyYSB1c2luZyBhbiBIU1ZEIGZpbHRlciBbQEJhcmtodWlqc2VuMTk4N10gICAgICAgfAp8IGBhbGlnbm1lbnRgIHwgV2hpY2ggbWV0aG9kIHRvIHVzZSBmb3Igc2hvdC10by1zaG90IGZyZXF1ZW5jeS1hbmQtcGhhc2UgY29ycmVjdGlvbiBbQEV2YW5zMjAxMzsgQE5lYXIyMDE1OyBATWlra2Vsc2VuMjAxODsgQE1pa2tlbHNlbjIwMjBdIHwKfCBgdXNlX3ByZWFsaWduX3JlZmAgfCBJbiBzb21lIGNhc2VzLCB1c2luZyBgUm9idXN0U3BlY1JlZ2AgdG8gYWxpZ24gSEVSTUVTL0hFUkNVTEVTIGRhdGEgY2FuIHJlc3VsdCBpbiB3b3JzZSBhbGlnbm1lbnQgY29tcGFyZWQgdG8gdGhlIHByZS1hbGlnbmVkIGRhdGE7IHNldHRpbmcgdGhpcyBwYXJhbWV0ZXIgdG8gMSB3aWxsIG1ha2UgYFJvYnVzdFNwZWNSZWdgIHVzZSB0aGUgYXZlcmFnZWQgcHJlLWFsaWduZWQgc3Vic3BlY3RyYSBhcyByZWZlcmVuY2VzIHRvIGFsaWduIHRoZSBhdmVyYWdlZCBwb3N0LWFsaWduZWQgc3Vic3BlY3RyYSwgd2hpY2ggbWF5IGltcHJvdmUgdGhlIGZpbmFsIGFsaWdubWVudDsgdGhpcyBoYXMgbm90IGJlIHRlc3RlZCBleHRlbnNpdmVseSB8CnwgYGZpdF9yZXNpZF93YXRlcmAgfCBXaGV0aGVyIHRvIG1vZGVsIHRoZSByZXNpZHVhbCB3YXRlciBzaWduYWwgaW4gdGhlIGRpZmZlcmVuY2Ugc3BlY3RydW07IHVzZWQgdG8gY2FsY3VsYXRlIGEgd2F0ZXIgc3VwcHJlc3Npb24gZmFjdG9yIHwKfCBgd2VpZ2h0ZWRfYXZlcmFnaW5nYCB8IFdoZXRoZXIgdG8gYXZlcmFnZSB0aGUgZGF0YSB1c2luZyB3ZWlnaHRlZCBhdmVyYWdpbmc7IHRoZSBkZWZhdWx0IGFwcHJvYWNoIHVzZSBpcyBtZWFuLXNxdWFyZWQgZXJyb3IsIGJ1dCBvdGhlciBhcHByb2FjaGVzIGNhbiBiZSBzZXQgaW4gYFNpZ25hbEF2ZXJhZ2luZy5tYCB8Cgp8IDx1PkZsYWdzPC91PiB8IDx1PkRlc2NyaXB0aW9uPC91PiB8Cnw6LS0tLS0tLS0tLS0tLS0tLS0tfDotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfAp8IGBIRVJNRVNgICAgfCBTZXQgdG8gYDFgIGlmIHRoZSBkYXRhIHdlcmUgYWNxdWlyZWQgdXNpbmcgSEVSTUVTICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8CnwgYEhFUkNVTEVTYCB8IFNldCB0byBgMWAgaWYgdGhlIGRhdGEgd2VyZSBhY3F1aXJlZCB1c2luZyBIRVJDVUxFUyAoYEhFUk1FU2AgbXVzdCBhbHNvIGJlIHNldCB0byBgMWApICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwKfCBgUFJJQU1gICAgIHwgU2V0IHRvIGAxYCBpZiB0aGUgZGF0YSB3ZXJlIGFjcXVpcmVkIHVzaW5nIFBSSUFNICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAp8IGBwaGFudG9tYCAgfCBTZXQgdG8gYDFgIGlmIHRoZSBkYXRhIHdlcmUgYWNxdWlyZWQgaW4gYSBwaGFudG9tICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8CnwgYGpvaW5gICAgICB8IFNldCB0byBgMWAgdG8gam9pbiBtdWx0aXBsZSBmaWxlcyAodGhpcyBjYW4gYmUgYmF0Y2hlZCBhY3Jvc3Mgc3ViamVjdHMpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwKfCBgbWF0YCAgICAgIHwgU2V0IHRvIGAxYCB0byBzYXZlIHRoZSBvdXRwdXQgc3RydWN0dXJlIGFzIGEgTUFULWZpbGUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAp8IGBjc3ZgICAgICAgfCBTZXQgdG8gYDFgIHRvIGV4cG9ydCBhIENTViBmaWxlIGNvbnRhaW5pbmcgdXNlZnVsIGRhdGEgZm9yIHN0YXRpc3RpY2FsIGFuYWx5c2lzIChhcHBsaWVzIHRvIGBHYW5uZXRGaXQubWAsIGBHYW5uZXRTZWdtZW50Lm1gIGFuZCBgR2FubmV0UXVhbnRpZnkubWApIHwKfCBgYXBwZW5kYCAgIHwgU2V0IHRvIGAxYCB0byBhcHBlbmQgUERGIG91dHB1dHMgaW50byBvbmUgUERGIChzZXBhcmF0ZWx5IGZvciBlYWNoIG1vZHVsZSkgKHJlcXVpcmVzIGBleHBvcnRfZmlnL2AgaW4gdGhlIGBHYW5uZXQvYCBkaXJlY3RvcnkgdG8gYmUgYWRkZWQgdG8gdGhlIHNlYXJjaCBwYXRoIGFuZCA8YSBocmVmPSJodHRwczovL3d3dy5naG9zdHNjcmlwdC5jb20vIiB0YXJnZXQ9Il9ibGFuayI+R2hvc3RzY3JpcHQ8L2E+IHRvIGJlIGluc3RhbGxlZCBvbiB0aGUgdXNlcidzIG1hY2hpbmUgKE5COiBtYWNPUyB1c2VycyBzaG91bGQgdXNlIDxhIGhyZWY9Imh0dHBzOi8vcGFnZXMudW9yZWdvbi5lZHUva29jaC8iIHRhcmdldD0iX2JsYW5rIj50aGlzIHZlcnNpb248L2E+IG9yIHVzZSA8YSBocmVmPSJodHRwczovL2Zvcm11bGFlLmJyZXcuc2gvZm9ybXVsYS9naG9zdHNjcmlwdCIgdGFyZ2V0PSJfYmxhbmsiPkhvbWVicmV3PC9hPiB0byBpbnN0YWxsIEdob3N0c2NyaXB0KSB8CnwgYGhpZGVgICAgICB8IFNldCB0byBgMWAgdG8gbm90IGRpc3BsYXkgb3V0cHV0IGZpZ3VyZXMgfAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgojIyBMb2FkaW5nICYgcHJlcHJvY2Vzc2luZwoKPGJyPgoKKipQYXJlbnQgZnVuY3Rpb24qKgoKYEdhbm5ldExvYWQubWAKCjxicj4KCioqRXhhbXBsZSB1c2FnZToqKgoKYGBge29jdGF2ZSwgZXZhbCA9IEZBTFNFfQpNUlNfc3RydWN0ID0gR2FubmV0TG9hZCh7J1MwMV9HQUJBXzY4X2FjdC5zZGF0J30sIHsnUzAxX0dBQkFfNjhfcmVmLnNkYXQnfSk7CmBgYAoKT3V0cHV0OgoKPGltZyBzcmM9ImltYWdlcy9yZWZlcmVuY2UvR2FubmV0TG9hZC1leGFtcGxlLnBuZyIgYWx0PSJBIHNjcmVlbnNob3QgZXhhbXBsZSBvZiBHYW5uZXRMb2FkIG91dHB1dCI+CgpBKSBFZGl0ZWQgZGlmZmVyZW5jZSBzcGVjdHJhIGJlZm9yZSBhbmQgYWZ0ZXIgZnJlcXVlbmN5IGFuZCBwaGFzZSBhbGlnbm1lbnQuIFVzZXJzIHNob3VsZCBsb29rIG91dCBmb3IgcG9vciBhbGlnbm1lbnQgYW5kIHNpZ25hbCBkaXN0b3J0aW9ucyBmcm9tIGxpcGlkIGNvbnRhbWluYXRpb24gb3IgZ2hvc3RpbmcgYXJ0aWZhY3RzIFtAS3JlaXMyMDA0XS4KCkIpIFRoZSBvYnNlcnZlZCBmcmVxdWVuY3kgb2YgZWl0aGVyIHRoZSByZXNpZHVhbCB3YXRlciBzaWduYWwgb3IgMyBwcG0gQ3IgcGVhayBvbiBhIGF2ZXJhZ2UtYnktYXZlcmFnZSBiYXNpcy4gVXNlcnMgY2FuIHVzZSB0aGlzIHBhbmVsIHRvIGNoZWNrIGZvciBwYXJ0aWNpcGFudCBtb3Rpb24gYW5kL29yIHNjYW5uZXItcmVsYXRlZCBmcmVxdWVuY3kgZHJpZnQuIFRoZSBzb2xpZCBibGFjayBsaW5lIGlzIHRoZSBub21pbmFsIHdhdGVyIG9yIDMgcHBtIENyIGZyZXF1ZW5jeSwgd2hpbGUgdGhlIGRhc2hlZCBsaW5lcyByZXByZXNlbnQgKy8tMSBzdGFuZGFyZCBkZXZpYXRpb24gb2YgcG9wdWxhdGlvbi1sZXZlbCBmcmVxdWVuY3kgb2Zmc2V0cyBvYnNlcnZlZCBpbiB0aGUgQmlnIEdBQkEgc3R1ZHkgW0BNaWtrZWxzZW4yMDE3XS4gSW4gb3RoZXIgd29yZHMsIGZyZXF1ZW5jeSBzaGlmdHMgYmV5b25kIHRoZXNlIGxpbWl0cyBpbmRpY2F0ZXMgYWJvdmUtYXZlcmFnZSBvZmZzZXRzIHRoYXQgc2hvdWxkIGJlIG9mIGNvbmNlcm4gdG8gZGF0YSBmaWRlbGl0eS4KCkMpIEEgc3BlY3Ryb2dyYW0gb2YgdGhlIDMgcHBtIENyIHNpZ25hbCBhdmVyYWdlIGJ5IGF2ZXJhZ2UgYmVmb3JlIGFuZCBhZnRlciBmcmVxdWVuY3kgYW5kIHBoYXNlIGFsaWdubWVudC4gVGhlc2UgZGF0YSBjb21wbGVtZW50IHRoZSBkYXRhIHNob3duIGluIHBhbmVsIEIgYnkgYWRkaXRpb25hbGx5IHNob3dpbmcgc3BlY3RyYWwgZGlzdG9ydGlvbnMgaW4gZWFjaCBhdmVyYWdlLgoKRCkgVGV4dHVhbCBkZXRhaWxzIG9mIHRoZSBkYXRhIGFuZCBwcm9jZXNzaW5nIHByb2NlZHVyZXMuIFdoZW4gIm4vYSAtIHdndC4gYXZnLiB1c2VkIiBpcyBzaG93biBmb3IgIlJlamVjdHMiLCB0aGlzIG1lYW5zIHRoZSBkYXRhIHdlcmUgYXZlcmFnZWQgdXNpbmcgd2VpZ2h0ZWQgYXZlcmFnaW5nLCB3aGljaCBkb3duLXdlaWdodHMgYmFkIChpLmUuLCAicmVqZWN0ZWQiKSBhdmVyYWdlcy4KCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKIyMgU2lnbmFsIGZpdHRpbmcKCjxicj4KCioqUGFyZW50IGZ1bmN0aW9uKioKCmBHYW5uZXRGaXQubWAKCjxicj4KCioqRXhhbXBsZSB1c2FnZToqKgoKYGBge29jdGF2ZSwgZXZhbCA9IEZBTFNFfQpNUlNfc3RydWN0ID0gR2FubmV0TG9hZCh7J1MwMV9HQUJBXzY4X2FjdC5zZGF0J30sIHsnUzAxX0dBQkFfNjhfcmVmLnNkYXQnfSk7Ck1SU19zdHJ1Y3QgPSBHYW5uZXRGaXQoTVJTX3N0cnVjdCk7CmBgYAoKT3V0cHV0OgoKPGltZyBzcmM9ImltYWdlcy9yZWZlcmVuY2UvR2FubmV0Rml0LWV4YW1wbGUucG5nIiBhbHQ9IkEgc2NyZWVuc2hvdCBleGFtcGxlIG9mIEdhbm5ldEZpdCBvdXRwdXQiPgoKQSkgRWRpdGVkIGRpZmZlcmVuY2Ugc3BlY3RydW0gKHNwZWN0cmEpIHdpdGggZml0dGVkIG1vZGVsIGZ1bmN0aW9uKHMpIG92ZXJsYWlkLiBUaGUgZml0IHJlc2lkdWFscyBhcmUgYWxzbyBzaG93bi4gTkI6IFdoZW4gbW9kZWxpbmcgdGhlIEdBQkEgcGVhaywgR2FubmV0IGFwcGxpZXMgd2VpZ2h0cyB0byB0aGUgcmVzaWR1YWwgQ2hvIHNpZ25hbCBkYXRhIHBvaW50cyBhdCAzLjE2IHRvIDMuMjg1IHBwbS4gVGhpcyBpbXByb3ZlcyBmaXR0aW5nIG9mIHRoZSBHQUJBIHBlYWsgd2hlbiB0aGVyZSBhcmUgc3VidHJhY3Rpb24gYXJ0aWZhY3RzLgoKQikgUmVmZXJlbmNlIHNwZWN0cmEgKHdhdGVyIGFuZCBDcikgd2l0aCBmaXR0ZWQgbW9kZWwgZnVuY3Rpb25zIG92ZXJsYWlkLiBUaGUgZml0IHJlc2lkdWFscyBhcmUgYWxzbyBzaG93bi4gSWYgbm8gd2F0ZXIgcmVmZXJlbmNlIGRhdGEgd2FzIGdpdmVuIGR1cmluZyBkYXRhIGxvYWRpbmcsIG9ubHkgQ3IgaXMgc2hvd24uCgpDKSBUZXh0dWFsIHJlc3VsdHMgZnJvbSBHYW5uZXRGaXQgKGZ1bGwgZGV0YWlscyBjYW4gYmUgZm91bmQgb24gdGhlIFtEYXRhIHF1YWxpdHkgbWV0cmljc10oaHR0cHM6Ly9tYXJrbWlra2Vsc2VuLmdpdGh1Yi5pby9HYW5uZXQtZG9jcy9kYXRhLXF1YWxpdHktbWV0cmljcy5odG1sKSBwYWdlKS4gRm9yIHRoZSBtZXRhYm9saXRlcyBsaXN0ZWQ6CiAgICAtIEFyZWEgaXMgdGhlIGludGVncmF0ZWQgc2lnbmFsIChpbiBhcmJpdHJhcnkgdW5pdHMpIG9mIHRoZSBwZWFrcyBzaG93bgogICAgLSBMaW5ld2lkdGggaXMgdGhlIGZ1bGwtd2lkdGgsIGhhbGYtbWF4aW11bSAoRldITSkgKGluIEh6KQogICAgLSBTTlIgaXMgZGVmaW5lZCBhcyB0aGUgc2lnbmFsIG1vZGVsIGFtcGxpdHVkZSBkaXZpZGVkIGJ5IHR3aWNlIHRoZSBzdGFuZGFyZCBkZXZpYXRpb24gb2Ygbm9pc2UKICAgIC0gRml0IGVycm9yIGlzIGRlZmluZWQgYXMgdGhlIHN0YW5kYXJkIGRldmlhdGlvbiBvZiByZXNpZHVhbHMgZGl2aWRlZCBieSB0aGUgc2lnbmFsIG1vZGVsIGFtcGxpdHVkZSBtdWx0aXBsaWVkIGJ5IDEwMAogICAgLSBRdWFudGlmaWNhdGlvbiBkZXRhaWxzIGNhbiBiZSBmb3VuZCBvbiB0aGUgW1F1YW50aWZpY2F0aW9uICYgdGlzc3VlIGNvcnJlY3Rpb25dKGh0dHBzOi8vbWFya21pa2tlbHNlbi5naXRodWIuaW8vR2FubmV0LWRvY3MvcXVhbnRpZmljYXRpb24tdGlzc3VlLWNvcnJlY3Rpb24uaHRtbCkgcGFnZS4KCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKIyMgVm94ZWwgY28tcmVnaXN0cmF0aW9uCgo8YnI+CgoqKlBhcmVudCBmdW5jdGlvbioqCgpgR2FubmV0Q29SZWdpc3Rlci5tYAoKPGJyPgoKKipFeGFtcGxlIHVzYWdlOioqCgpgYGB7b2N0YXZlLCBldmFsID0gRkFMU0V9Ck1SU19zdHJ1Y3QgPSBHYW5uZXRMb2FkKHsnUzAxX0dBQkFfNjhfYWN0LnNkYXQnfSwgeydTMDFfR0FCQV82OF9yZWYuc2RhdCd9KTsKTVJTX3N0cnVjdCA9IEdhbm5ldEZpdChNUlNfc3RydWN0KTsKTVJTX3N0cnVjdCA9IEdhbm5ldENvUmVnaXN0ZXIoTVJTX3N0cnVjdCwgeydTMDFfc3RydWMubmlpJ30pOwpgYGAKCk91dHB1dDoKCjxpbWcgc3JjPSJpbWFnZXMvcmVmZXJlbmNlL0dhbm5ldENvUmVnaXN0ZXItZXhhbXBsZS5wbmciIGFsdD0iQSBzY3JlZW5zaG90IGV4YW1wbGUgb2YgR2FubmV0Q29SZWdpc3RlciBvdXRwdXQiPgoKQSkgQ28tcmVnaXN0cmF0aW9uIG9mIHRoZSBNUlMgdm94ZWwgb24gdGhlIGNvcnJlc3BvbmRpbmcgc3RydWN0dXJhbCBNUiBpbWFnZS4gVGhlIHRocmVlIG9ydGhvZ29uYWwgc2xpY2VzIGFyZSBzaG93biBhdCB0aGUgdm94ZWwgY2VudGVyLgoKQikgVGV4dHVhbCBkZXRhaWxzIG9mIHRoZSB2b3hlbCBnZW9tZXRyeS4KCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKIyMgVGlzc3VlIHNlZ21lbnRhdGlvbgoKPGJyPgoKKipQYXJlbnQgZnVuY3Rpb24qKgoKYEdhbm5ldFNlZ21lbnQubWAKCjxicj4KCioqRXhhbXBsZSB1c2FnZToqKgoKYGBge29jdGF2ZSwgZXZhbCA9IEZBTFNFfQpNUlNfc3RydWN0ID0gR2FubmV0TG9hZCh7J1MwMV9HQUJBXzY4X2FjdC5zZGF0J30sIHsnUzAxX0dBQkFfNjhfcmVmLnNkYXQnfSk7Ck1SU19zdHJ1Y3QgPSBHYW5uZXRGaXQoTVJTX3N0cnVjdCk7Ck1SU19zdHJ1Y3QgPSBHYW5uZXRDb1JlZ2lzdGVyKE1SU19zdHJ1Y3QsIHsnUzAxX3N0cnVjLm5paSd9KTsKTVJTX3N0cnVjdCA9IEdhbm5ldFNlZ21lbnQoTVJTX3N0cnVjdCk7CmBgYAoKT3V0cHV0OgoKPGltZyBzcmM9ImltYWdlcy9yZWZlcmVuY2UvR2FubmV0U2VnbWVudC1leGFtcGxlLnBuZyIgYWx0PSJBIHNjcmVlbnNob3QgZXhhbXBsZSBvZiBHYW5uZXRTZWdtZW50IG91dHB1dCI+CgpBKSBBeGlhbCB2aWV3IG9mIHRoZSBwcm9iYWJpbGlzdGljIHZveGVsIHRpc3N1ZSBzZWdtZW50YXRpb24gbWFwcyBmb3IgZ3JleSBtYXR0ZXIgKEdNKSwgd2hpdGUgbWF0dGVyIChXTSksIGFuZCBjZXJlYnJvc3BpbmFsIGZsdWlkIChDU0YpLgoKQikgVGV4dHVhbCBkZXRhaWxzIG9mIHRoZSBDU0YtY29ycmVjdGVkIG1ldGFib2xpdGVzIHZhbHVlcyAoc2VlIFtRdWFudGlmaWNhdGlvbiAmIHRpc3N1ZSBjb3JyZWN0aW9uXShodHRwczovL21hcmttaWtrZWxzZW4uZ2l0aHViLmlvL0dhbm5ldC1kb2NzL3F1YW50aWZpY2F0aW9uLXRpc3N1ZS1jb3JyZWN0aW9uLmh0bWwpIGZvciBmdXJ0aGVyIGRldGFpbHMpIGFuZCB0aGUgdm94ZWwgdGlzc3VlIHZvbHVtZSBmcmFjdGlvbnMuCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiMjIFF1YW50aWZpY2F0aW9uCgo8YnI+CgoqKlBhcmVudCBmdW5jdGlvbioqCgpgR2FubmV0UXVhbnRpZnkubWAKCjxicj4KCioqRXhhbXBsZSB1c2FnZToqKgoKYGBge29jdGF2ZSwgZXZhbCA9IEZBTFNFfQpNUlNfc3RydWN0ID0gR2FubmV0TG9hZCh7J1MwMV9HQUJBXzY4X2FjdC5zZGF0J30sIHsnUzAxX0dBQkFfNjhfcmVmLnNkYXQnfSk7Ck1SU19zdHJ1Y3QgPSBHYW5uZXRGaXQoTVJTX3N0cnVjdCk7Ck1SU19zdHJ1Y3QgPSBHYW5uZXRDb1JlZ2lzdGVyKE1SU19zdHJ1Y3QsIHsnUzAxX3N0cnVjLm5paSd9KTsKTVJTX3N0cnVjdCA9IEdhbm5ldFNlZ21lbnQoTVJTX3N0cnVjdCk7Ck1SU19zdHJ1Y3QgPSBHYW5uZXRRdWFudGlmeShNUlNfc3RydWN0KTsKYGBgCgpPdXRwdXQ6Cgo8aW1nIHNyYz0iaW1hZ2VzL3JlZmVyZW5jZS9HYW5uZXRRdWFudGlmeS1leGFtcGxlLnBuZyIgYWx0PSJBIHNjcmVlbnNob3QgZXhhbXBsZSBvZiBHYW5uZXRRdWFudGlmeSBvdXRwdXQiPgoKQSkgQXhpYWwgdmlldyBvZiB0aGUgcHJvYmFiaWxpc3RpYyB2b3hlbCB0aXNzdWUgc2VnbWVudGF0aW9uIG1hcHMgZm9yIGdyZXkgbWF0dGVyIChHTSksIHdoaXRlIG1hdHRlciAoV00pLCBhbmQgY2VyZWJyb3NwaW5hbCBmbHVpZCAoQ1NGKS4KCkIpICBFZGl0ZWQgZGlmZmVyZW5jZSBzcGVjdHJ1bSAoc3BlY3RyYSkgd2l0aCBmaXR0ZWQgbW9kZWwgZnVuY3Rpb24ocykgb3ZlcmxhaWQuCgpDKSBUZXh0dWFsIGRldGFpbHMgb2YgdGlzc3VlLWNvcnJlY3RlZCBtZXRhYm9saXRlIHZhbHVlcyAoc2VlIFtRdWFudGlmaWNhdGlvbiAmIHRpc3N1ZSBjb3JyZWN0aW9uXShodHRwczovL21hcmttaWtrZWxzZW4uZ2l0aHViLmlvL0dhbm5ldC1kb2NzL3F1YW50aWZpY2F0aW9uLXRpc3N1ZS1jb3JyZWN0aW9uLmh0bWwpIGZvciBmdXJ0aGVyIGRldGFpbHMpLgoKPGJyPgoKIyMjIFJlZmVyZW5jZXMKCgoK</div>
<!DOCTYPE html>
<br>
<hr>
<p style="text-align: right;">Built with <a href="https://rmarkdown.rstudio.com/" target="_blank">R Markdown</a> in <a
    href="https://posit.co/products/open-source/rstudio/" target="_blank">RStudio</a>.
  <br><br>
</p>
<p style="text-align: right;">Copyright &copy; 2020&ndash;2023, Mark Mikkelsen <a
    href="https://creativecommons.org/licenses/by/4.0" target="_blank"><img id="cc"
      style="height:22px!important;margin-left: 3px;vertical-align:text-bottom;" src="images/license/cc-xlarge.png"><img
      id="cc" style="height:22px!important;margin-left: 3px;vertical-align:text-bottom;"
      src="images/license/by-xlarge.png"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("reference.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
